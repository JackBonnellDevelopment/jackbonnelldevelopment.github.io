{{- $params := .Scratch.Get "params" -}}

<div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>
                    {{- with .Site.Params.dateformat | default "2006-01-02" | .Lastmod.Format -}}
                        {{- dict "Date" . | T "updatedOnDate" -}}
                        {{- if $.Site.Params.gitRepo -}}
                            {{- with $.GitInfo -}}
                                &nbsp;<a class="git-hash" href="{{ printf `%v/commit/%v` $.Site.Params.gitRepo .Hash }}" target="_blank" title="commit by {{ .AuthorName }}({{ .AuthorEmail }}) {{ .Hash }}: {{ .Subject }}">
                                    <i class="fas fa-hashtag fa-fw" aria-hidden="true"></i>{{- .AbbreviatedHash -}}
                                </a>
                            {{- end -}}
                        {{- end -}}
                    {{- end -}}
                </span>
            </div>
            {{- with $params.license | string -}}
            <div class="post-info-license">
                <span>
                    {{- . | safeHTML -}}
                </span>
            </div>
            {{- end -}}
        </div>
        <div class="post-info-line">
            <div class="post-info-md">
                {{- if $params.linktomarkdown -}}
                    {{- with .OutputFormats.Get "markdown" -}}
                        <span>
                            <a class="link-to-markdown" href="{{ .RelPermalink }}" target="_blank">
                                {{- T "readMarkdown" -}}
                            </a>
                        </span>
                    {{- end -}}
                {{- end -}}
            </div>
            <div class="post-info-share">
                <span>
                    {{- $socialMap := resources.Get "data/social.yml" | transform.Unmarshal -}}
                    {{- $socialArr := slice -}}
                    {{- range $key, $value := .Site.Params.social -}}
                        {{- $social := $key | lower | index $socialMap | default dict -}}
                        {{- if $value -}}
                            {{- if reflect.IsMap $value -}}
                                {{- with $value.weight -}}
                                    {{- $social = dict "Weight" . | merge $social -}}
                                {{- end -}}
                                {{- with $value.prefix -}}
                                    {{- $social = dict "Prefix" . | merge $social -}}
                                {{- end -}}
                                {{- with $value.template -}}
                                    {{- $social = dict "Template" . | merge $social -}}
                                {{- end -}}
                                {{- with $value.id -}}
                                    {{- $social = dict "Id" . | merge $social -}}
                                {{- end -}}
                                {{- with $value.url -}}
                                    {{- $social = dict "Url" . | merge $social -}}
                                {{- end -}}
                                {{- with $value.title -}}
                                    {{- $social = dict "Title" . | merge $social -}}
                                {{- end -}}
                                {{- with $value.newtab -}}
                                    {{- $social = dict "Newtab" . | merge $social -}}
                                {{- end -}}
                                {{- with $value.icon -}}
                                    {{- $social = dict "Icon" . | merge $social -}}
                                {{- end -}}
                            {{- else if ne $value true -}}
                                {{- $social = dict "Id" $value | merge $social -}}
                            {{- end -}}
                            {{- if $social.Icon.Simpleicons -}}
                                {{- $prefix := ($.Scratch.Get "cdn" | default dict).simpleIconsPrefix -}}
                                {{- $social = dict "Prefix" $prefix | dict "Icon" | merge $social -}}
                            {{- end -}}
                            {{- $socialArr = $socialArr | append $social -}}
                        {{- end -}}
                    {{- end -}}
                    {{- range sort $socialArr "Weight" -}}
                        {{- partial "plugin/social.html" . -}}
                    {{- end -}}
                </span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags">
            {{- with .Params.tags -}}
                <i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;
                {{- range $index, $value := . -}}
                    {{- if gt $index 0 }},&nbsp;{{ end -}}
                    {{- $tag := partialCached "function/path.html" $value $value | printf "/tags/%v" | $.Site.GetPage -}}
                    <a href="{{ $tag.RelPermalink }}">{{ $tag.Title }}</a>
                {{- end -}}
            {{- end -}}
        </section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">{{ T "back" }}</a></span>&nbsp;|&nbsp;<span><a href="{{ .Site.Home.RelPermalink }}">{{ T "home" }}</a></span>
        </section>
    </div>

    <div class="post-nav">
        {{- if .PrevInSection -}}
            <a href="{{ .PrevInSection.RelPermalink }}" class="prev" rel="prev" title="{{ .PrevInSection.Title }}"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>{{ .PrevInSection.Title }}</a>
        {{- end -}}
        {{ if .NextInSection }}
            <a href="{{ .NextInSection.RelPermalink }}" class="next" rel="next" title="{{ .NextInSection.Title }}">{{ .NextInSection.Title }}<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a>
        {{- end -}}
    </div>
</div>
